<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="TodoXaml.Views.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:TodoXaml.Views"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    xmlns:models="using:TodoXaml.Models" xmlns:c="using:TodoXaml.Converters"
    mc:Ignorable="d"
    RequestedTheme="Light"
    Background="White">

    <Page.Resources>
        <c:PriorityBrushConverter x:Key="PriorityBrushConverter" />
    </Page.Resources>
    <Grid Background="White">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="300" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <CommandBar Grid.Row="0" Grid.Column="0" VerticalContentAlignment="Center"
                 Background="White"
                 Foreground="Black"
                 DefaultLabelPosition="Right">
            <CommandBar.Content>
                <TextBlock Margin="12,0,0,0" Foreground="Black" 
                           Style="{ThemeResource SubtitleTextBlockStyle}" 
                           Text="To-Dos" />
            </CommandBar.Content>
            <AppBarButton Icon="Add" Label="Add" Click="OnAddButtonClick"
                          Foreground="Black" Background="White">
                <AppBarButton.Resources>
                    <SolidColorBrush x:Key="AppBarButtonForegroundPointerOver" Color="Black"/>
                    <SolidColorBrush x:Key="AppBarButtonBackgroundPointerOver" Color="#FFDDDDDD"/>
                </AppBarButton.Resources>
            </AppBarButton>
        </CommandBar>

        <TextBlock Grid.Row="0" Grid.Column="1"
                   Text="To-Do item"
                   FontSize="25"
                   VerticalAlignment="Center"
                   HorizontalAlignment="Left"
                   Foreground="Black"
                   Margin="20,0,0,0"/>
        <ListView x:Name="TodosListView" Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" ItemsSource="{x:Bind Todos}"
                  Background="White">
            <ListView.ItemTemplate>
                <DataTemplate x:DataType="models:TodoItem">
                    <StackPanel Orientation="Vertical" Padding="10" Background="White">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock Text="{x:Bind Title}"
                                       FontWeight="SemiBold"
                                       Foreground="{x:Bind Priority, Converter={StaticResource PriorityBrushConverter}}"
                                       Margin="0,0,10,0" />
                            <SymbolIcon Symbol="Accept" Visibility="{x:Bind IsDone, Mode=OneWay}" Foreground="Green"/>
                        </StackPanel>
                        <TextBlock Text="{x:Bind Description}" Foreground="Black"/>
                        <TextBlock Text="{x:Bind Deadline.ToString('yyyy.MM.dd', x:Null)}" Foreground="Black" />
                    </StackPanel>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>
        <Border x:Name="EditForm"
         Visibility="{x:Bind IsFormVisible, Mode=OneWay}"
         Background="White"
         BorderBrush="LightGray"
         BorderThickness="1"
         Grid.Row="1"
         Grid.Column="1"
         Margin="8,0,8,8"
         Padding="10,15">
            <StackPanel Margin="10,0,0,10" Spacing="15" Background="White">

                <TextBox Header="Title" 
                 Text="{x:Bind EditedTodo.Title, Mode=TwoWay}" 
                 Background="White" Foreground="Black"/>

                <TextBox Header="Description"
                 Text="{x:Bind EditedTodo.Description, Mode=TwoWay}"
                 AcceptsReturn="True"
                 TextWrapping="Wrap"
                 Height="80"
                 Background="White"
                 Foreground="Black" />

                <DatePicker Header="Deadline"
                    Date="{x:Bind EditedTodo.Deadline, Mode=TwoWay}"
                    Background="White"
                    Foreground="Black"/>

                <ComboBox Header="Priority"
                  ItemsSource="{x:Bind Priorities}"
                  SelectedItem="{x:Bind EditedTodo.Priority, Mode=TwoWay}"
                  Background="White"
                  Foreground="Black"/>

                <CheckBox Content="Is Done"
                  IsChecked="{x:Bind EditedTodo.IsDone, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                  Foreground="Black"/>
                  
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Spacing="10">
                    <Button Content="Save"
                    Click="OnSaveButtonClick"
                    Background="DarkCyan"
                    Foreground="White"/>
                </StackPanel>

            </StackPanel>
        </Border>
    </Grid>
</Page>